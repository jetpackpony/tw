const AuthKeyExchange = require('./AuthKeyExchange/AuthKeyExchange');
const { bytesFromHex } = require('./primeFactorization');

const outgoing = [];
const incoming = [
  Uint8Array.from(bytesFromHex("000000000000000001b8147f36d3c75d480000006324160583500050383b6d22b88cbdf4dfdbe3b5b91044e2146a99af137d7b82455df063082bf5cfd76480983900000015c4b51c02000000029f4ba16d109296216be86c022bb4c3")),
  Uint8Array.from(bytesFromHex("000000000000000001805c9b37d3c75d780200005c07e8d083500050383b6d22b88cbdf4dfdbe3b5b91044e2146a99af137d7b82455df063fe50020050cbe0e9062a6ba4c0ecba1f27f48882e6be9c8c07abf6eed23e7556a317957d7be069e02fdbdef1c67d9b5c1223330e9fef66989e926290d451fcd3d2f2b8ccee7d4cca89f87e5ec6ab46f69089d99ad481ed52f3038085960d8fc0395de89cc7d03b2b18cfb13b12550aeb7173553f7cf8f2e20e5ceb7dc2849f959c02be4c15b9bfc0e7683a959b5e40618196f5f11d5fc3b5e31ad425f86030a802dc2cf2cfe4a217e7957bd02c7372a19f679786022df291236334f68438308707a1c76ff79321954fee86e65ed7e38b4a46f746805963691facfeda57c47e675da6efecd34dba65bf41f0b201cd7f18773107d7e839992f9724f5a7a34428623e7e2851f539951919ea9d9bba8f32b1665b25847276068d98b973bbf1070c6bd03b26f258f6ffc5febf4c793f908b645847f7e33bbd0cbb17d9291a6635ac5b63fe75b1871d3833a1269bfaf01e0e735b8b1813150250bc7ed3843b21f42a549e2b7be6147ac7623e723855cf575eaecbb4e8519804c14a01c8b93b88d4b11b166f09e7763ecf2c3869a443c88c1767b37853a4d1c81b9fb15f16d0f58d0ae201d11e51c59aff89fd25f6adb6c51ed84fdbf9dc407baee1c58cdc5be2acc21fb8204787d9ee4421b85875a9cf24de15260835967bccda335263c032af72a4ccc03a5a05d17a33f401add1522999bfc08b52d4fc4311fc8440bfaf03fdbc08a0cb49abd7039322df39d7916be5e788c79fe58e1f07d5f7aae4ebeab16e9959ef79d6d7d2354bb059ffc92732795fc2b3e51c088ac9d54f3aa5e69e3ca57d573b66c06f3c413fed577f21334bf6a23b5940229d70")),
];

const exchange = new AuthKeyExchange({
  msg_id_hex: "5DC7D33600000000",
  nonce: Uint8Array.from([
    131, 80, 0, 80, 56, 59, 109, 34,
    184, 140, 189, 244, 223, 219, 227, 181
  ]),
  newNonce: Uint8Array.from([
    17, 145, 76, 188, 4, 134, 79, 73, 121,
    177, 225, 70, 233, 124, 47, 210, 103,
    188, 91, 224, 146, 23, 96, 84, 63,
    218, 142, 210, 237, 97, 247, 239
  ])
});

outgoing.push(exchange.makeNextMessage());
exchange.processMessage(incoming[0]);

outgoing.push(exchange.makeNextMessage());
exchange.processMessage(incoming[1]);

console.log();